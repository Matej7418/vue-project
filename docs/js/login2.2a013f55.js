"use strict";(self["webpackChunkchat"]=self["webpackChunkchat"]||[]).push([[314],{620:function(e,a,l){l.r(a),l.d(a,{default:function(){return U}});var t=l(3396),i=l(4870),u=l(9242),n=l(1635);l(7139);const s=["onSubmit"],r=(0,t._)("label",{for:"email"},"Email",-1),o=["value"],v=(0,t._)("label",{for:"username"},"Name",-1),c=(0,t._)("label",{for:"website"},"Website",-1),d=["value","disabled"],m=["disabled"];var p={__name:"Account",props:["session"],setup(e){const a=e,{session:l}=(0,i.BK)(a),p=(0,i.iH)(!0),b=(0,i.iH)(""),f=(0,i.iH)(""),w=(0,i.iH)("");async function _(){try{p.value=!0;const{user:e}=l.value;let{data:a,error:t,status:i}=await n.O.from("profiles").select("username, website, avatar_url").eq("id",e.id).single();if(t&&406!==i)throw t;a&&(b.value=a.username,f.value=a.website,w.value=a.avatar_url)}catch(e){alert(e.message)}finally{p.value=!1}}async function h(){try{p.value=!0;const{user:e}=l.value,a={id:e.id,username:b.value,website:f.value,avatar_url:w.value,updated_at:new Date};let{error:t}=await n.O.from("profiles").upsert(a);if(t)throw t}catch(e){alert(e.message)}finally{p.value=!1}}async function y(){try{p.value=!0;let{error:e}=await n.O.auth.signOut();if(e)throw e}catch(e){alert(e.message)}finally{p.value=!1}}return(0,t.bv)((()=>{_()})),(e,a)=>((0,t.wg)(),(0,t.iD)("form",{class:"form-widget",onSubmit:(0,u.iM)(h,["prevent"])},[(0,t._)("div",null,[r,(0,t._)("input",{id:"email",type:"text",value:(0,i.SU)(l).user.email,disabled:""},null,8,o)]),(0,t._)("div",null,[v,(0,t.wy)((0,t._)("input",{id:"username",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>b.value=e)},null,512),[[u.nr,b.value]])]),(0,t._)("div",null,[c,(0,t.wy)((0,t._)("input",{id:"website",type:"website","onUpdate:modelValue":a[1]||(a[1]=e=>f.value=e)},null,512),[[u.nr,f.value]])]),(0,t._)("div",null,[(0,t._)("input",{type:"submit",class:"button primary block",value:p.value?"Loading ...":"Update",disabled:p.value},null,8,d)]),(0,t._)("div",null,[(0,t._)("button",{class:"button block",onClick:y,disabled:p.value},"Sign Out",8,m)])],40,s))}};const b=p;var f=b;const w=["onSubmit"],_={class:"col-6 form-widget"},h=(0,t._)("h1",{class:"header"},"Supabase + Vue 3",-1),y=(0,t._)("p",{class:"description"},"Sign in via magic link with your email below",-1),g=["value","disabled"];var k={__name:"Auth",setup(e){const a=(0,i.iH)(!1),l=(0,i.iH)(""),s=async()=>{try{a.value=!0;const{error:e}=await n.O.auth.signInWithOtp({email:l.value});if(e)throw e;alert("Check your email for the login link!")}catch(e){e instanceof Error&&alert(e.message)}finally{a.value=!1}};return(e,i)=>((0,t.wg)(),(0,t.iD)("form",{class:"row flex-center flex",onSubmit:(0,u.iM)(s,["prevent"])},[(0,t._)("div",_,[h,y,(0,t._)("div",null,[(0,t.wy)((0,t._)("input",{class:"inputField",type:"email",placeholder:"Your email","onUpdate:modelValue":i[0]||(i[0]=e=>l.value=e)},null,512),[[u.nr,l.value]])]),(0,t._)("div",null,[(0,t._)("input",{type:"submit",class:"button block",value:a.value?"Loading":"Send magic link",disabled:a.value},null,8,g)])])],40,w))}};const S=k;var O=S;const H={class:"container",style:{padding:"50px 0 100px 0"}};var x={__name:"Login2View",setup(e){const a=(0,i.iH)();return(0,t.bv)((()=>{n.O.auth.getSession().then((({data:e})=>{a.value=e.session})),n.O.auth.onAuthStateChange(((e,l)=>{a.value=l}))})),(e,l)=>((0,t.wg)(),(0,t.iD)("div",H,[a.value?((0,t.wg)(),(0,t.j4)(f,{key:0,session:a.value},null,8,["session"])):((0,t.wg)(),(0,t.j4)(O,{key:1}))]))}};const C=x;var U=C}}]);
//# sourceMappingURL=login2.2a013f55.js.map